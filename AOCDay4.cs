/*
2642
row #0)        S...S.S..SAMX.S.....S.SS..S.XMAS......SS.....XS.X.X......SAMX............S..SAMX...S........X..XX.S.......XMAS....X..........X..SAMX..XSAMX.
row #1)        .A.XAA.A..X..A.......AAA..AA..A......A.AA....MA..MS......X...X....S......A...S...SAMXSAMX....M.MS..ASAMX.S.......M.M........M.....SAMXMA....
row #2)        S.M.M...MM..M.X..S....MM..M.MM...X..M...MM..SAMXA.AA....M.S.M.M..AA...SS.M..A.XSAMX.....MS....AA....M...A.......A.X.A......AS..XMAS...AM....
row #3)        .A.XXMASAX.X.M..A...S.XX..XXXX....MXMASAMXX..SXSS..SM..A..XA...AM.M....A.X.M.SAMXM......A.XS.SMS.....X.M.X.....SXMASXS....SA.......X.XSXS..S
row #4)        S.M.S..S....A..M....A..SAMXXMAS....A...XM......A....XXSS.MS.M..XS.X....MM.XX...SA......MSMA..XA.....X.X.S.M.....A...AM.S..M.........M..A..A.
row #5)        .AXXA.X..X.S.XX....SM...A...MA.....SSSMAXMAS..M.....MMA.A..A.X.........X.XMM..AS.S....X.AM...M...S.M.M.A...AS..S.M.M..A..X.....S...A.AM..M..
row #6)        ..M.M.M...M.M.SM.S.AX..S.M.XMAS....AAAS......XMAS..A.MAS...SM.......SAMX.A.A.M..A...X..SXMASX...A.A.A.M..XMASAMX..X.XM.S......A...S..XS.XMAS
row #7)        .AAXXAA..X.A..A.A..M......XXMAS...MMS..........A..S.X..S...A.X..........S.XSX..MS...M..SAMXMAS.M.S.S.XMAS.MAS......MX........M........M.....
row #8)        S.SM..SSM.S.S.MM.SAX...........X.XXXX.........M............M..SAMXS.S......M..XMAS..A....M.SAMX....S..SA.XMA....X.A.XMAS....X..........A....
row #9)        ..A...AAA.SAMXXMASAMXS..........M.MXMAS......XX.X..S..SXMASX...ASA.SA.......A..XMAS.S...ASAMX.X...A..XMASXM..S.MSS.S..A.A.SAMX..........S...
row #10)       .S...MSM.M..M....S....A.....S....AAAAX.....X.XMSM..A.AMXM.MM....MA.AM.SX.....SAMX..XAA.S...S.M...M...X..MX....A.A.ASAMXS.M...S..SS.X....XMAS
row #11)       ....X..X..XA......A.S..M.....A....S.SMM...M.M.AXA..MMAM..A.A...X.XMMXA..M........M..M.M...A...A.X.......MX..XS.MMM..A.A...X..SA.A...M..X.M..
row #12)       ....M.S..SS.S......M.A..X.XS..MS...A.A.A.A.A..SMSM.XSAS.S.SS.SS....XM.S..A......X.A.XAXX.M.....S....X..A..S.MSAMXS...M........AMM....AM...A.
row #13)       X.X.A.XA..AA...X...SX.M..M..A.AX..M.SSM.S.S....A..XAS..A...AAA.....XMAS...S....M.XXS..SMX..........SSMS...A.A..X.SAMX.X......SXMX...SAS....S
row #14)       SM.MSM..MSMM.SM.....AM.XA.AS.M...X.AA..X.......SMSM..S.XMASMM.......M......X.XA..SM.....A.......X..AA.A...MMS.M....M.....SAMXXA.X..AS...XMAS
row #15)       .AA.A...AX..XA.......MAS..ASX.XMASMM.S.....S....AXA.A....XXX...X...X.....SM..SM..AAA.X...S......MSM.SMMS.SX..A......XMASA....M.M..M......M..
row #16)       ..MS.S.MS.S.SM.....XX.XSAM.......XXXA.....A......MSM...XMAS.M.SM........AA.X.X.A.MS.S.M..A.SAMX.AX...AXAA...SSM........M.....AA.XX.X..S...A.
row #17)       ..AX..XA..A..X..S...M.M.XMAS...S.S.MM....M........X.X...M....A.A.......MS.X.MXS.SX.A...A.M..A.SMS.....MM...XA.AXS...S.XMAS...S....MX.A.....S
row #18)       .M.XSXMAS.M.M.MA....AAA..SX.AXA.AAX.XA..X....S.....S.....A..M.SS......X..M.AMAMAM.M..XS.SX.XSMXAX.....XXA...M.MM.A.AS..S...S.....ASAMX......
row #19)       X.M.AXMAS.XA..MAX...SSS...A..MMM.M...MS...XSX.A...AS..SAMXSX.A...S......A.SA..SAMX.AM..A...MA.XSM........SAMXA..X.MASAMXA.A...X.S.SXSA......
row #20)       SA..MXMAS.S..X..SM....A....MX.XA.X....A....MA..M.MA........XM...A.A....S..S...S.SXMAS...MS.AM...AX....S.....S.S..XMX....SM...M.A..MA..S.S...
row #21)       SA..X.M.S..X.X..A.A.X..M....XM..SAMX...S..A.AM..XM.........XM..M.S.M.......XMASXMASA....AX.SX...SM...A.......AA..XM.....XAX.A.M..A..M.AASAMX
row #22)       .XM...SA..XMASMSM..S.M..X...A.....SAMX...S...SX.XMAS....S..M.AX.A...X.......M.SXXAMXS..M....A...AXX.M..X......M..A.X....SMMS.XS.S....XM.SAMX
row #23)       SAMX...ASX.AX.AAX...X.A....S......S.S.XSAMXMASX...X.A..A...A..SM.....M.....X.AX.M.MX..XMAS...M..MMMX..M.X.....XXS.M.S.X..AAX.A....X..XX.SAMX
row #24)       ...A....M.MS.M.SSM.SM.SS........SA.....M...SAMX....M.MM.XS.SAMX..S....ASAMX.MSMXAAXMASAMXMASAMX.XAA..A..SM..SM...A.AS.SMS.MSM....M....S.SAMX
row #25)       ..S.S..S.X.AX.A...A.A.A........AM.....X.A...A.......AXX.AM...X....A...AS...X.AA.SXS......SAMXSSSSSS.S...A.A.A...S.MA...AA..X..XMAS.S.AX..A..
row #26)       ..A...XAXS..SMXSAMXSSMM...S...MX.......X.S.S.........S.M..A...MS...MSM.X..X..MS.MAS.........X.AAAX.XA...M..SM....XMAS...MS...S.S.SA.MSMM..M.
row #27)       ..M..X.M.MA.XMA.X..M..X...A..X..X.......M...........X.X....S...AA..AX..MSM...X.AMA........S...MMMMMMM...X..AX....XS.....XX...AA.AMAX..A.A..X
row #28)       ..X.M..XA.AMAM....X.A.....M.....XM.......A..S......M..S........XSMM....AA.....SXM........A....XXXA.AX..SAMXM.....A.....MM..X.M.MXM.M..SM.S.M
row #29)       ...A...S.S.SX....M...S.X..XX...M..A.X.....S..A....A..AA...S..S.XMXX.X..SM.....MX....X...M.....X.XSXSS.X.A.AX.S..M.....AAA.SM.X..X.X.X...XX.A
row #30)       ..S....A.A..A...A...XMASM.M...A....SM....XA...M..S..M.M...A.A...MAM.M...XX...A...S.M...X.......MMM....SMSMSSXA.X.....SS.S.XAX....SAMX...M..S
row #31)       .X.....M.M...M.S........XAA..S....A.AXMASMM....X...XS.XMASMM.....ASAA.S...M.S...A.AS.XMAS.......A..X...AAAX.MMSAMX..A.....MSMM....AM...A....
row #32)       SSM..S.X.X....XMASAMX.SMS.S......M..S....AXAS.S......A..X.X.XS....S.SXMAS..A...M.SA......S.....SSSM.....MS.SAX.A...M......A.AXA...AM..S....S
row #33)       AAAAA...........X.A...AA.....SAMXX.......SMAS.A.......M..M.M.SAS..XXXMASMXMAS.X.AMA.....A.XS...A.A.SAMXXXX.AS...MXX...S.SMS.SM.S.S.SX.XMAS.A
row #34)       M.MMS..........S.M.M.S..M...A...S.M.......MX..M....X...X..A...AM..SMM...MX.A...MX..M...M.M.MA..MSS..XMAS.X.M.XSSMX.....AXA..A.X...A...S....M
row #35)       X.XXX.......X..SA.A.X....X.M.SAMXA.A.....X...SX...M......S.S.M.MX.AAAA.A..M...X....SX.X.A...AM.X.A........MXM.XA........M.M.MS...M.M...ASAMX
row #36)       MSM...S....M..A..M.SM.....X......XMASX.SS....A..XA...X..A.X.XS..XS.SMSS..X.A.XMASAMXAM.S.S.S.SXS.M........XAXXSMM......X.X.XXMASXMASXS..M...
row #37)       AAA.XMAS..A..M...XX.AXMAS..M.SXMAS.XM...ASAMXM.MS...SM.M..XMASAMX.AA.XMASM..S......XAMA..SA..SAMXX..S.....SMSAMXAX..........X..MXMAS..A..X..
row #38)       SMS.M.M..S..XX..M..MS.......AXXX.X.A....MM...XA......AX.....A..M.M.M.X.A.A......S.MS.MXSAMXM.M.XA.S.SA...AAAA..A.SX......S.MS.ASXMAS.S.M...S
row #39)       .X..A.XSA..S..MA....A......M.SMMMMS....SX.XS.S.S.....SM......S.SXS.XM.MX.S.....A.AX.X..MXM.MX..M.S.A.AM.MSM.MS..SM......A.A.ASA...XS..A.X.A.
row #40)       SAMXS..MA...A.SA.....S....X...AAAA......AM..AXA.......AX.X....A.AX.ASXM.....SSM.S.M.S.X.AX..A..A....M.MX.X..X..SA......MXS..MM...XMX...M.M..
row #41)       ..M..AXSAMX.SM..S.S......M....SSSS.....SAMAM.MM..XMAS.MMM......MMMS..A.X....AXA.A.A..A.SMSM..S.SAMX..X.X.......SAMXS.XXS.M..X.SAMXAM..XSX.XX
row #42)       .A....M..SXSAMX..A......A....X........AS..XSX.XAM.S..A.AXA....XAX.XXS.M.M..MM..MM.S...MA.AAA...........X.....S...M.A.MXMASA..A.A..SA..AMMMMM
row #43)       SX.....X.A..M.M.M......S....M......SAMX..X..X..ASA..S.SMS.S...S..M..M..X.AXXX...XA....SX.M.MSAMX.....X..M.....A.XSXM.A.SAMXSM.S.M..S.MA.AAAA
row #44)       .M......XMASX.AX...........A.S......XXMASXM.M.SAM.....AA........A....AM...SMSAMXMAS......X..X.SMX....M...A...S.MA.MX.S...SXX.X...X..XS.SSSSS
row #45)       .A...XMASX.XX.S.....SAMX..S...A........SAMXAA.MX.....SM.M.SXS..S.X..SAS....A...XX.....S.M..SS..A.M...A..S.S.ASAMX.A..X....M..M.....X.SAMX...
row #46)       .S.....A...MXMAS....S.M..XMAS..M.........A..SXMX.....X...XAAMX..M..ASA.....S...M.....A.AX.A.A..SM.A..S..A..MXSXM..S.M....A..XA..SSM.........
row #47)       ......M....A..A.....XA..........XMAS....SS...AS.M.SAMX....M.MA.A..MXM.S..SX...AA....MSS..M..MM...X.SX...M.X..MA....A.X..SX..MS.AAAX.........
row #48)       .....X.....S.MSS...MS.M........X.........A..SAM..A.A..S.SXXA..S..XMX...A.AXM.S.S..SX.A..X.A.X.X..S..MS..X....SAXMAS...M.MS..A.MMSMSS........
row #49)       .......S.SAMX.XA.XA....XX....SM......X....M.M..XSSS....A.AS.SA...A......MM.SAMXA.A.M.M...M.S.M....A.AX...S..A..S.......AA..MSXX.A..A........
row #50)       ....X..AA......MMSM....XMAS..AA...S...M....X...A..AXMAS.M.M.M...S.......AX..AS.MM..A.XXMASA.AX.X...MS.M...AMSAMX......SMS.XMAS.S...MM.......
row #51)       ...MM..M.M...S..AX.A..MXA...S..M...A...AS.M..SM....M..X..XXX.....X.....SXS..XMXX...S...M...SM.M...X.XXMAS.XM..X....S..X.X.X........X.X......
row #52)       ..AXA..X..X.XA.M.S..SAM.S....A..X...M..ASA...XA.....X..M.M.MM.SXM.M..S.M.MAM.MX.X.AXA...A..A.A..S.....S.S...XXXMAS..AM.XMASMS...............
row #53)       .SMSS......SAMXS....SA........MM.....XMAS.M..SAMX.......A..A.A.AMX.A..A...AMA....M.MXMASXSS.S....A...A......M.M.A...AM..A..XAAX.S...........
row #54)       .AAA...X.....XA.X...S....S....AX.XSAMX....SX.X.XX...X..S.S.SM.S.MAS.SS.M.S.SX...XXAA.SXM.XMASXMAS.M.M.....XA..A.SS.SS.X.S...MSM..A...S.XMAS.
row #55)       SM.M.SM....S.MMSM.....X.XMAS.S.MM..A....SA.MM.M.M....M....AX...A.XSA....X.....S.M..SA.AM...........X.....MSM..S.AAAAA......S.AAX..M...AX..A.
row #56)       XX.X.A.....AX..AA...S..M.S.M...A.A..M...MA.A.A.AAA....A....M..S..M..M.XSAMXX.A.A..XMAS.MA........SMSX...AX..A..XMMMMM.....XA..SMM..X..MM..M.
row #57)       ..M.SM.....M....S....A..A.ASXSSSS.S..XSX..MS..S.S.S....S..S.X....ASAMX.M....M.S.M.X.....XS.SXS.S.AA..M.S..M..SM.X..XX......M...AXAX.XAX.X.XS
row #58)       .ASAMX.....X.X..X.....MS.SXMA.AA......A....X.......X.X...A.......S.X.X..A..X.A...X..S..S..AMA.A.SM.M.SA....A.AXMAS...M.....XA..SMMSMSM.MX.A.
row #59)       SXMAS...S.S...M.MM....AX.M.MXMM.S..S.SM.X..X........MM..MXMAS..XX...MMS..SS.M.SAMX..A.AS..AM.M..X...XMAS....SXM...A..SA.....XSAX.XA.AAA.XMAS
row #60)       ...A...A...AS..AA.A..M.SAMXM.XXA.A.AA.X..MSM.......S.A.X......SM.M...A.A.A...A.A..S.MM..ASX.X.X........M..SAMXA....MA.AS...M.M..MSMSMSMSXMAS
row #61)       X.M...M....XMAS.SSXSXMAS..A...M.S.MM..S...AA..XMASA..SS......A.A..AX.SSXMAS...S....AX..SAMXM.M........X.X..AS.S...SMX..M.XA.X.A..AAAX..XAMAS
row #62)       MX..SX..XMASMXM..MA.X....S..SX.A.AXX.A.XX.MS...X.M.S......X.M.SS.SMS..MXMX..........M.XMASX.A.A......M.M..S.A..A..XAXMASXSM....S..SMS....MAS
row #63)       A..A.XMAS...SAMXA..M......A.A...S.M.M.MMM.X...MSX...A....M.X..AAAA...A..SAMX.........X..XMAS.S.S....A.A.....M...MSMMM......A.......XX...X.XS
row #64)       S.M.M..AS.....SS..A.X......MMSAMXAXX.AAAA....AA..MS..M..AXMAS.MMSSS.SS....SA....X......SAMX..XAAXMAS.S......X....XAXAX.X....S...S..S.......X
row #65)       .X.A....SA.SAMXA.S...M......X.X.S.MMSSSSS...SM....AA..XS.SM..AXXAA.X.A.S....S..M.....S......MM.MS.....A.X.........SMMSAMX..A....A...A.....M.
row #66)       ..S.......M.AS.SM..S..A......M.X...XA.......XS.....SM..AAXMAS.MMM.M..M..A.....A......A..S..AXAAX.A..X.XM......X.XMASXA.A.XMAS...MX...M...A..
row #67)       ...........X.MA.AXASAMXSAMX.A...M..S.S...S.SAMXS.....X.M..S.S.XX.A...X...M...S.......M..A.S..S....M..MAMX....MMM...M..SS.XXX....X.M.SXX.S...
row #68)       .............MXM.M.SAMX.A.XS.....A..A....AAMAXA.......XX.A..X...S......S.SX.....S.S..XS.M...X......X.SA.A...A.A.A.A.......M.M......AM....XX.
row #69)       ......XMASAMXX..XXX..M.S.M.M.S....S..M...MXMSMMSS......MMS...M.........SAMX.X....A...A..XSAMXS.S..SX...S.S.S.SSS.S........AA.AS...MAS...MMS.
row #70)       ..S..S....XMASM.M.....X.A.X.AS..SAMX..X..X.AX.XA.......XA.....A....SAMXM.M...M..M.M.M.....A.A.A.AAX.M........AA...X..X....SXSASAMXSX.X.AAA..
row #71)       .S.A..A.X.X...AAXXX.XM.S.M.M.SAMX.....S..XMAS.MMS......M.S...SXS......X.A.X...AX...X.....S.M.M..MM...A.......M.S.MMS.XMASAMXM.SX....MMSSM...
row #72)       ..A.M..M.M.M..SMSM.MA..A..X....M...XMASXSXMASX..A.....XX....XMASAMX....S.......S...XS.....X.X..XA.X...S.X...XXA.A.A...XA.A.XSAMXM....A.X....
row #73)       ..XM.XA.X.A.A.A.XAASA..M...XSX..X...MA..MA.AS....S....MM....AMAM..M.............A.XM.A.....M.S.S.S.......M..XMAS.MS..M..S.M.MAS.SA...SSX....
row #74)       .SAMXS.M.SSSSSM..SAMXS.XMASAMX.....XMASASAMXMASXX.....AA...SXM..X.A......X....S..M.A.XM...A...A.A..S......A.X.X.XMASA..A.A.XS....AS.....MS..
row #75)       ..ASA.A.AAA..AX..........AMASA.....X.XS..XSX.A.MSMS..SSSS...XX.X.MSS.SS.MMS....AA.XSM..X.S.SAMXM...A.......S.M.MMM.S..M.SAMX......M......AX.
row #76)       .XAM.S.MM..M.MMSAMX.X...MXSAMXS....MMMS.....M..A.AAA.A.A....MMMS..AA.A.A.A.A...SM..AX.........X.XX.M..S.....A.X.A.A..X..XAXS.S...S.X.....MS.
row #77)       .MM.X.XX....XX.X..SM...X..M.M......A.A.....X...S..MSMMM...SAAAA..M.SMMS..S..MXMASXSMM...XMAS..SMSMSX.A.X...SSXSMSS.S..SSSM.SAMX.A.......AXAX
row #78)       X..A........M.M...A......XSAMX....SSMS........X.A..X.XS.SAS.SMSSX..X.X.A.A...XX...AXA.S.M......AAA.XMASAMX..MA.AASAMX.A.A.AM.M.M.......S..M.
row #79)       ....S...S..AAAXMASMS......S.S.....AXA..........M.M..M..AMA.AXAA........SMM.X.M...SS.SA..A.....M.MSMXSA...A.AM.M.MS....MSMMXSAMX.AXMAS.A..AX.
row #80)       .........AS.S...A.X.A......AA..S..MM............A.X.SA.XM.M.M.M.......A..XMSA..SAMXAM.X.S...SX.XXXAXMASXMASX...X.X....X.X.X......S...M..S...
row #81)       ...X...X..M....M...M.M....M.M.ASAMXA.........SAMXS.A.AS..XXX.XXX.....M...A.SA..XMASXMM..A....A..M.MMS.M.M.S..........S............X.X......X
row #82)       ...SMSM....X..XMAS.SAMX..X.XXMAS.M.SXMAS.S.....M..M...M..M..M.MM....XS..S....MM....AAX..M.....M.AA.AXA.XMASAMX......X.A....XMAS..M...X.....M
row #83)       ...AAA.X...........S.S.MSMMMXS..AX.....XA.XMASA..X.....XA...SA..A..S..A......AX...SSMX..X......XSX..S.M.M.S.........MM.M...X....A...MS.....A
row #84)       ...MS.S.M...........A..AAAAAA.AS..M...MM.M.SXSA..SM...MS.X..SAS..S.AA.XMAS..S...X..AMXS.S...S.S..MS....X.....S..S...A.A.X...M..S...A.XA....S
row #85)       ..XX.....A..XMAS...S.MMXSS.MS..M...A.AX.A...AM.M.A.A.A..M..X.XMAS..M.M..XA.X..SSMS.AMA...A...A.X.A.....MS.....A.A.X.S..SAMX..A.A..SSM..M....
row #86)       ..M.......SM.X.....A.XXXM.X....XX...SM.S.....MA.XMS.S..A..M.SAMX...X..X..M.M..A.AASAMX....M.M.M.MS.SAMXA.......MMS.M.S...M....SM..AA....X...
row #87)       .A........A.M......M..MSMA.M..M.....A.....S.SSXSMXMAS.S..ASAMX.XX.X.X....X.A.MMSSM.X.......X.A.X.XA..SMS........XAXSAMX.A......X.MS.M....M..
row #88)       SAMX.....S.A...X...X..AA.AS.AAX.X.SSM......AXMASA.M.M.A.S......MMMSM....XMASX.XA.XXMS.......S....MM..XAA.......M.M.MSS.S........X....X....A.
row #89)       S..M......S...SAMXS.M.SMS.S.SS.MM.A.XMAS..M.M..MS..A.XM.....XMASXAA.AXMAS..A..MM..SA..XMAS......X.SAMXSM.XSAMXA.AXX.A..........M.XXX.......S
row #90)       .A.AX....A.XMASAMAMASAMX....XMASA.MS.....X...X..X...SXX.S....S.MMSSS.S.....M..AX.AMS..S.....SS......SAMXXMS.XS.S.SM.MS........A...MSM.......
row #91)       .SMSMM.SM...S..AM.SAM.SXMAS..S..SSXXAS.SAMXSSS..S.....M..A....AXA...XS..S.SX..S.MX..XAX.....AA..X.X..A.X.AX..M..XMASX.....XMAS....AA.A......
row #92)       ..AXA.AX.X.A..SAMXMASX..XA....SAMXM..MA...A.AAX..A.XMASA..M..SS.S..M..AA.A.....XS.S.MM.....MMMS.MMMM..M.MSM...A.S.SM.S.....SAMX...SMS.S.S.S.
row #93)       .M.MSM.SM.M......XSAMX..SMS.....SA.SAMXM.M.M.MM.S.M.....S.SX.A....A...MMM...X..X.A.XA....XX.XXA.A.A.A..X.AA....SAXA.X.A.X.A....MSAMXMASA.A..
row #94)       X..AX..A.X.A......M....A.AA....XSA...X..XSX.A.XX.A.X.XMASA.AM....S...X.XXMASM.M.M.MSS....M.M.SM.S.SS.S....S..S..MSM.S..M.M......A..SS.M.M...
row #95)       S..SS.S.....S....X.A.SM...MS..M..XM..M.MA..S....S.M..S..M..XM.......S..M....AA.X...X.....AA..AX..XA.A......AA..AXXX.A.AXX.X.....XSAA.X.XXMAS
row #96)       SAMXAXMAS...S.......SXA...SX.A..M..X.AAM.........A.XA..X.....XS....A...A..XSS..M.SAMX....S.X.M..M.MM.......MM.S.M.M.MSMM.M.....M.MMSMM.M..A.
row #97)       ..M.MMM..A.A.......SM..M...AS..A..S..SXMASX.....S.MM......S..AM...M....S.MA.X..A..........M.SXSA..XA......X..X..ASAAXA.AA.....A.XXAA.AA..M..
row #98)       ..XXXA.A..M..X.....AA.S.X...M.S....A..MM.M........XX......A.MXMASX....A.AM.S.MSS..X....XMAS.AAS...S.S.......X...SAS.SSSS.....S...MSS.SX.X...
row #99)       S.MMSS.SSXSXM.....S..M.A.M...XA....XM.A.A.....X...SM......MXMAS.SAMX.M.SXM..A.A....M.S.MS...M.....A..A.....M.....M...A.A....X.X.X.....MS....
row #100)      A.AA.ASAMXMA..........X.M.A.X.MX.X.M.XSS.S.S...M..AA.....SXX....SAMXX.....XS.MMS....A..A...XX.....MS..M...A......X...MMMM..S.M.M.MX...AA....
row #101)      M.SS..MM..SAM......XMAS..X.S.MXMSM.AX..S..A...XMASMSM...AA.M....XA...X..XMAS..X..S.M.S.S.XMAS.....X.A..X.S...........X.X.X..ASA.AMA.S.SM..SX
row #102)      X......X..S.SX......M.........AAAA.S.MA..M.XS....SX..X.M.M.AA..MS....M..AM..AM.SAMX....A.....AX.XMAS.M..XMAS......X...X...XSAMXSAS.S.A.X.A.M
row #103)      SAMX....MA..MX.......A.........SMS...MA.X..M.A.....XX.XX.X.S.SA......A.SX.ASAMAM.......M..S...MM.S....X....XMAS....M.M.M.MXM.MXSX.....MXM..A
row #104)      ....M...MA.A.M....X...S.......A.XX..X..S...A..M.XMASMSMS.SX..S.......S.A..AS.MXSAMXS...XS.A...AXA.XS........MS......A...ASXMAS.M.S.S..SXM..S
row #105)      ..X..A.X..S..A.S.MS..A.......M..MM....A....S..SX..AAAAA.A..M........A..M.M..X.....A.A..AM.M..SSM..AMX........AA..S.S.S.S.SASASAXA...A.AXMAS.
row #106)      ...M..S......S..A.A.M.......X..A..A..M.....XA.A..M.MSSSM.M..A......M...XXXMAS....MS..MM.SAX...X..M..AM........SM..A.A.....XMAS.M.....MM...S.
row #107)      ....A.......X..S.MMX......S...S....SX.......MMM.X.XXAAX.X.X..S....X.....SAMX....XAAX.XX..AS.....X..X.SAMX..XX...X..MS.....X.X.XAX...S.X.....
row #108)      .....S.SAMX.M.....X...S....A.X......XXMASXMASAX....M.M.XMAS.........S.SAMX..MSS.M.M.......M..S...M.M.S.S.M.MMS...XXAXA..S......S...A........
row #109)      ......A.A.X.A.......XA..S.S.M........MS.......S.S.X..XM.SAMX......SA.SAMXMASXA.X.AX..XSAMX.X.AA.X.AA.XA...AA.AA...MMMMM.A....XMAS.M.........
row #110)      .....M.S.M..SAMX....M..A..XA.X.......AA........AA....A.XMAS...S...MA..M....SMMS.S..M.MM.MS...M.M.M.S..MM.S.SS.SM.XAAA.AXMAS.M....XS.S.......
row #111)      ..S.XMASA.X........XA.MSSMS.M.......MSMS.SS...M.M...S..X.....A...X..M.X...AXAXA.....AA.A.A...X..X.A....AX.AA....XSS.S..SX..A..S..A...A......
row #112)      ...A..AS.M.M.S......SX.XAAA..X.X...X..X..A.A.X..X.....X.....M...S...XX...M.SXMAS...S.SS.SM..M..M.M.S..SMSMM.....XXAX......S..AXXM.....M.X...
row #113)      ....MM..A.XSAS.....X..XSMMM...M.MSM.M.S..M..M.S...S.S.MS...X...A...M.SAMX.A...X.A...AAAA.XMAS.A.X.A..AAAXXMAS...MSSMM.S.....MMMX...S...X.M.S
row #114)      ....XX.S.MAMAS.S...M.M...AXX.A.A.AA.XA...X.A.XAA..AA..A.......M...A......MSS....SM.X.MM.M.S.AS...M.SMSM........AA.A.XA..X..XAAA....XA.....A.
row #115)      .S.SM....MXM....A..AA.....SMSSS.S.SMM.S...S...M.MSMXMMS......XSX.S...SS.X..A.X.AX.X.MXXASAMXM.X.X.XXXXX.......S.SXMMM.SM..MSS.S..SM..M..XM.S
row #116)      X.AA....XXX.S.S..M.S....X...A.A.AAAXX.........X.AXXMXX........XAMXMASA.X...MM.M..MS..AS.....XM..MMMMMM...........MXXX.AX.A.......A..X.XMX...
row #117)      .MSM.SAMXMMX.A....XX....XMXMASMMMSM....S.S.SS.SM...A..XMASX.SM..MA..MM.MS..XSXMAS.A...S.S..XA...AA..A.A........XSAMX.S.MS..XSXX.SM.S.MA..M..
row #118)      X.AXX.A.A..AM.M.....M....MA...XXXA.X....A.AA..XA...S.....M.AAA.X.XSX.X.A.A..MAMXS.MS....A.SSM.SSS...SS.SXMAS..S.MSM....A.X.AM.MX.X.A.SA...A.
row #119)      .MSSMS.S...XSA.X.....A..XMAS.XMMS.M....M.MM...M.M.......A.MSS.M...MXM..S.XM..AMA..X.X...M.XA.A...X..X.A.A....A...A....SSM.MASAA.M..M...SAMXS
row #120)      ..AAXA.AA..MM.S....S..S..M.S.MA.AA.SAMX.XXX...A..X.....SXX.A.A.X..MA.A..MM.XMASXS..M....X..MM.S...M..M.S.M..M..SS.S....A.XS..ASXMASXSAMX..A.
row #121)      XMASMMSM.M.A.A....A...XA..AS.AS.SSM....M.M.M..S.......A.M.M.S.M..A.SS.SA.A.SS.M...A.XMAS.X.XAX.X...AXMASAMXXX.AAAASAMXS.M.SAMXM...SA...SXMAS
row #122)      M....XAX..XSSXS.SMS....MM..SASX.A..XS...AA..A.X......M..AXSA.A..S...A.S..S..AA...S.M......MS.SM.....S.AS.M.M.MMSM...M....XMAS.SXMAS.M..AXM..
row #123)      A....SMS....MAX.XA......AX...M.M..X.XA..SS...S.M....XS..SMA.SS..A..SAMXX....SM....A.......XAXAA......M...XXAXXAXX....X..M..A..SAMX...X.MXMAS
row #124)      S...XAA....A..MMM.M......S..A.X...M.M.MA.X......A...AM...AM.A...M....SXMM....XXMASAMX.XMASMMSM.M....X.SAMX.SXMMS...S...AS.M....XMAS....X...S
row #125)      ....SM....S..XAXA..X.......S..X...A.AXMXM..SAMX..S.M..A..SXMAS..XMASA..XAA....M...........AX.XA.X..M...ASM.MXXAA..A...SAMX...X...XS....S....
row #126)      ....XXA...X.MSS..S.....S.....XMAS.S.SXMAS.....SAMXX....S..X.X......M...M.SSS...A.........SSMS..S..A...SA.AA...MSSM..S.M.....MS.SM.....A..S..
row #127)      ...M.SSSSMSA...A.X.SS...A....XA.XA.A.ASAS.S.SA..M..........M......XMAS.A.AA.....S...S.S..A.SXA...S....MA.S.....AXX..AX.....A.AAAA...XMASA...
row #128)      ..A..AAAA.SA....M...AA...M..M.SM.SM...MASA.AM..A.......X..A.X.....M.XMASMM.M...SAMX.XA..MM.A..M......X..M....X..SXM.M.....S..MSM.M..XSAMX...
row #129)      .S.S.MMSM.SAMX.A.X...MM...XAXAA.AX.X...XM.MXMAS........M.S.SM.....AXSAMXX...X....S.MM.MX.X.MS..X.........XMAS.M.M..AX..SAMX..X.XX.XMASX...X.
row #130)      XMAS.XX.XXSAMXS.M.....XX..SMMSSM........MX.X.X.....X.X.A.AA.A.....SMSAMX........A.AX...X...XA......XMAS........A..S.S.......S....S..XSAMXM..
row #131)      .M..AM.........A.......XX.AX.AX.........SAM........M.M.S.M..S..S...A.XMAS......M.S..MS....X.MX.........A....S.S.SAMX........A....AA..M..A...
row #132)      XXA.AM.......SS.....S..M.S.SM.S.S........ASA...SAMXA.A..XX...ASAMXSS.S........X......AA.X..MX.M.......X.M..A.X..S..XM....S..M..X.M.M..AS.S..
row #133)      SM.S..X.....AXMAS..XAXAA...XA.AA.X.X......M.SX.....S.S.SX.....MM..AAAS................SM.S..A..A.....SMS.XMXMASAS..M.A..A...X...MX..XMASX...
row #134)      .AX........M......M.MS.S...M.MMS.SMS....SAMXAM.S.SA.A..MAS.S..XX..MMM.A.......S.......A.XXA..S..S....XA.AX.A..M..A.A..SM.........A....A..M..
row #135)      .SM.......X......A.AXX.....A.XXA.AAA.X..SAMXMA..AM.M.MA..MA.AM....X.XX.M.SAMX..A.X.S.S...M.M....A...M.SM.MS..X....MS..XMAS........S.SM.S..A.
row #136)      ..AXXMAS........S.S.M......S.M.MSX.MSMS.X.XXXSXMXMX.XSX.XXXMAMXMAS.S.M..X..S....M..A...X.AX.X...M..A.XX.X.X.X..X..SX....X.XX.....X.AXA.XA..S
row #137)      ..SM.M..A..........A........A..X.MMXXA...M.M.MXMASXM.M.MMM.SX.X.A.A...A...A....A.X.M....MSM..M..X.S...MMM.MMM.M...MA....MM.M......M...M..M.A
row #138)      ..A.X.A..M........S........S.M...A.AMS....AAA.A..SAMX.A.AA.....M.M.....S.M....S....X.....AA...A........AA.A.AA...ASAMX..A.AAA....X.A.A.X..XM
row #139)      .S.....SAMX...................X..S.XSAMX.S.S.S.S.S...S.SSS....X.XMAS....X..........SAMX...S....S........SSS.SS..S....X.SS..S.S......S......X
                                                                                                                                             
*/


using System;
using System.IO;
using System.Collections.Generic;
using System.Linq;


public class AOCDay4
{
    private string inputString;
    private string searchStr;
    private string searchStrRev;
    private int total;
    private int rows;
    private int cols;
    private char[,] the_map;
    private char[,] map_copy;


    public AOCDay4()
    {
        LoadInputString();
        searchStr = "XMAS";
        searchStrRev = "SAMX";
        total = 0;
    }

    private void LoadInputString()
    {
        foreach (string line in File.ReadAllLines("C:\\Users\\jglatts\\Documents\\AOC24\\input_day4.txt"))
        {
            if (line.Length > 0 && !string.IsNullOrEmpty(line))
                inputString += line + "\n";
        }
    }

    private void doCheckHorz(int i, int j, string checkStr)
    {
        if (the_map[i, j] == checkStr[0])
        {
            bool is_valid = true;
            int copy = j + 1;
            List<(int row, int col)> dims = new List<(int row, int col)>();
            dims.Add((i, j));
            for (int k = 1; k < checkStr.Length; k++)
            {
                if (copy >= cols)
                {
                    is_valid = false;
                    break;
                }
                if (the_map[i, copy] != checkStr[k])
                {
                    is_valid = false;
                    break;
                }
                else
                {
                    dims.Add((i, copy));
                    copy++;
                }
            }
            if (is_valid)
            {
                int idx = 0;
                for (int k = 0; k < dims.Count; k++)
                {
                    map_copy[dims[k].row, dims[k].col] = checkStr[idx++];
                }
                total += 1;
            }
        }
    }

    private void doCheckVert(int i, int j, string checkStr)
    {
        if (the_map[i, j] == checkStr[0])
        {
            int copy = i + 1;
            bool is_valid = true;
            List<(int row, int col)> dims = new List<(int row, int col)>();
            dims.Add((i, j));
            for (int k = 1; k < checkStr.Length; k++)
            {
                if (copy >= rows)
                {
                    is_valid = false;
                    break;
                }
                if (the_map[copy, j] != checkStr[k])
                {
                    is_valid = false;
                    break;
                }
                else
                {
                    dims.Add((copy, j));
                    copy++;
                }
            }
            if (is_valid)
            {
                int idx = 0;
                for (int k = 0; k < dims.Count; k++)
                {
                    map_copy[dims[k].row, dims[k].col] = checkStr[idx++];
                }
                total += 1;
            }
        }
    }

    public void Solve()
    {
        string[] vals = inputString.Split('\n');
        rows = vals.Length;
        cols = vals[0].Length;
        Console.WriteLine("rows " + rows + " - cols " + cols);
        the_map = new char[rows, cols];
        map_copy = new char[rows, cols];

        // fill the 2D map
        for (int i = 0; i < vals.Length; i++)
        {
            for (int j = 0; j < vals[i].Length; j++)
            {
                the_map[i, j] = vals[i][j];
                map_copy[i, j] = '.';
            }
        }

        // check for horiztonal and vertical matches
        for (int i = 0; i < rows; i++)
        {
            for (int j = 0; j < cols; j++)
            {
                doCheckHorz(i, j, searchStr);
                doCheckHorz(i, j, searchStrRev);
                doCheckVert(i, j, searchStr);
                doCheckVert(i, j, searchStrRev);
            }
        }
        diagLookUpNorm();    
        diagLookUpRev();    
        printFindings();
    }


    private void diagLookUpRev()
    {
        for (int i = 0; i < rows; i++)
        {
            for (int j = 0; j < cols; j++)
            {
                if (the_map[i, j] == searchStrRev[0])
                {
                    int copy_i = i + 1;
                    int copy_j = j + 1;
                    bool is_valid = true;
                    List<(int row, int col)> dims = new List<(int row, int col)>();
                    dims.Add((i, j));
                    for (int k = 1; k < searchStrRev.Length; k++)
                    {
                        if (copy_i >= rows || copy_j >= cols)
                        {
                            is_valid = false;
                            break;
                        }
                        if (searchStrRev[k] != the_map[copy_i, copy_j])
                        {
                            is_valid = false;
                            break;
                        }
                        else
                        {
                            dims.Add((copy_i, copy_j));
                            copy_i++;
                            copy_j++;
                        }
                    }
                    if (is_valid)
                    {
                        int idx = 0;
                        for (int k = 0; k < dims.Count; k++)
                        {
                            map_copy[dims[k].row, dims[k].col] = searchStrRev[idx++];
                        }
                        total += 1;
                    }

                    int copy_i_left = i + 1;
                    int copy_j_left = j - 1;
                    bool is_valid_left = true;
                    List<(int row, int col)> dims_left = new List<(int row, int col)>();
                    dims_left.Add((i, j));
                    for (int k = 1; k < searchStrRev.Length; k++)
                    {
                        if (copy_i_left >= rows || copy_j_left < 0 || copy_j_left >= cols)
                        {
                            is_valid_left = false;
                            break;
                        }
                        if (searchStrRev[k] != the_map[copy_i_left, copy_j_left])
                        {
                            is_valid_left = false;
                            break;
                        }
                        else
                        {
                            dims_left.Add((copy_i_left, copy_j_left));
                            copy_i_left++;
                            copy_j_left--;
                        }
                    }
                    if (is_valid_left)
                    {
                        int k = 0;
                        int idx = 0;
                        for (k = 0; k < dims_left.Count; k++)
                        {
                            map_copy[dims_left[k].row, dims_left[k].col] = searchStrRev[idx++];
                        }
                        total += 1;
                    }
                }
            }
        }
    }

    private void diagLookUpNorm()
    {
        for (int i = 0; i < rows; i++)
        {
            for (int j = 0; j < cols; j++)
            {
                if (the_map[i, j] == searchStr[0])
                {
                    int copy_i = i + 1;
                    int copy_j = j + 1;
                    bool is_valid = true;
                    List<(int row, int col)> dims = new List<(int row, int col)>();
                    dims.Add((i, j));
                    for (int k = 1; k < searchStr.Length; k++)
                    {
                        if (copy_i >= rows || copy_j >= cols)
                        {
                            is_valid = false;
                            break;
                        }
                        if (searchStr[k] != the_map[copy_i, copy_j])
                        {
                            is_valid = false;
                            break;
                        }
                        else
                        {
                            dims.Add((copy_i, copy_j));
                            copy_i++;
                            copy_j++;
                        }
                    }
                    if (is_valid)
                    {
                        int idx = 0;
                        for (int k = 0; k < dims.Count; k++)
                        {
                            map_copy[dims[k].row, dims[k].col] = searchStr[idx++];
                        }
                        total += 1;
                    }

                    int copy_i_left = i + 1;
                    int copy_j_left = j - 1;
                    bool is_valid_left = true;
                    List<(int row, int col)> dims_left = new List<(int row, int col)>();
                    dims_left.Add((i, j));
                    for (int k = 1; k < searchStr.Length; k++)
                    {
                        if (copy_i_left >= rows || copy_j_left < 0 || copy_j_left >= cols)
                        {
                            is_valid_left = false;
                            break;
                        }
                        if (searchStr[k] != the_map[copy_i_left, copy_j_left])
                        {
                            is_valid_left = false;
                            break;
                        }
                        else
                        {
                            dims_left.Add((copy_i_left, copy_j_left));
                            copy_i_left++;
                            copy_j_left--;
                        }
                    }
                    if (is_valid_left)
                    {
                        int idx = 0;
                        for (int k = 0; k < dims_left.Count; k++)
                        {
                            map_copy[dims_left[k].row, dims_left[k].col] = searchStr[idx++];
                        }
                        total += 1;
                    }
                }
            }
        }
    }

    public void printFindings()
    {
        Console.WriteLine(total);
        for (int i = 0; i < rows; i++)
        {
            string str = "row #" + i + ") ";
            Console.Write(str.PadRight(15, ' '));
            for (int j = 0; j < cols; j++)
            {
                Console.Write(map_copy[i, j]);
            }
            Console.WriteLine("");
        }
    }

    public void Print()
    {
        Console.WriteLine(inputString);
    }

    public static void Main(string[] args)
    {
        AOCDay4 a = new AOCDay4();
        a.Solve();
    }

}
